<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>GPU Support · ProbabilisticCircuits.jl</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-136089579-2', 'auto');
ga('send', 'pageview', {'page': location.pathname + location.search + location.hash});
</script><link rel="canonical" href="https://juice-jl.github.io/ProbabilisticCircuits.jl/stable/manual/gpu/"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="ProbabilisticCircuits.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit">ProbabilisticCircuits.jl</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox" checked/><label class="tocitem" for="menuitem-2"><span class="docs-label">Manual</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../demo/">Quick Demo</a></li><li><a class="tocitem" href="../queries/">Queries</a></li><li><a class="tocitem" href="../learning/">Learning</a></li><li class="is-active"><a class="tocitem" href>GPU Support</a><ul class="internal"><li><a class="tocitem" href="#Moving-to-GPU"><span>Moving to GPU</span></a></li><li><a class="tocitem" href="#GPU-APIs"><span>GPU APIs</span></a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">API</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/common/">Common APIs</a></li><li><a class="tocitem" href="../../api/types/">Type Trees</a></li><li><a class="tocitem" href="../../api/internals/probabilistic_circuits/">Probabilistic Circuits</a></li></ul></li><li><a class="tocitem" href="../../installation/">Installation</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>GPU Support</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>GPU Support</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/Juice-jl/ProbabilisticCircuits.jl/blob/master/docs/src/manual/gpu.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="man-gpu"><a class="docs-heading-anchor" href="#man-gpu">GPU Support</a><a id="man-gpu-1"></a><a class="docs-heading-anchor-permalink" href="#man-gpu" title="Permalink"></a></h1><p>Most queries and learning APIs support both CPU and GPU implementations. To use the GPU implementations you need to move the circuit and the dataset to GPU, then call the corresponding API.</p><h2 id="Moving-to-GPU"><a class="docs-heading-anchor" href="#Moving-to-GPU">Moving to GPU</a><a id="Moving-to-GPU-1"></a><a class="docs-heading-anchor-permalink" href="#Moving-to-GPU" title="Permalink"></a></h2><h3 id="Moving-Data-to-GPU"><a class="docs-heading-anchor" href="#Moving-Data-to-GPU">Moving Data to GPU</a><a id="Moving-Data-to-GPU-1"></a><a class="docs-heading-anchor-permalink" href="#Moving-Data-to-GPU" title="Permalink"></a></h3><p>Currently, the APIs support <code>CuArray</code> type of gpu implemetations. One simple way to move to gpu is using the <code>cu</code> function from <code>CUDA.jl</code>.</p><pre><code class="language-julia">using CUDA
train_x_gpu, test_x_gpu = cu.(train_x, test_x)</code></pre><p>In case of missing values we use <code>Missing</code> type, so for example if you have categorical features with some missing values, the data type on gpu would be <code>CuArray{Union{Missing, UInt32}}</code>.</p><h3 id="Moving-Circuit-to-GPU"><a class="docs-heading-anchor" href="#Moving-Circuit-to-GPU">Moving Circuit to GPU</a><a id="Moving-Circuit-to-GPU-1"></a><a class="docs-heading-anchor-permalink" href="#Moving-Circuit-to-GPU" title="Permalink"></a></h3><p><code>ProbCircuits</code> are stored in DAG structure and are not GPU friendly by default. So, we convert them into <code>BitsProbCircuits</code> (or bit circuits) as a lower level representation that is GPU friendly. The GPU version of bit circuits has type <code>CuBitsProbCircuit</code>, so to move your <code>circuit</code> to GPU you can simply do:</p><pre><code class="language-julia">bpc = CuBitsProbCircuit(circuit);</code></pre><h2 id="GPU-APIs"><a class="docs-heading-anchor" href="#GPU-APIs">GPU APIs</a><a id="GPU-APIs-1"></a><a class="docs-heading-anchor-permalink" href="#GPU-APIs" title="Permalink"></a></h2><p>The GPU supported APIs generally have the same name as their CPU counterpart, for a comprehensive list of supported functions see the API documentation. For example, we support the following on gpu:</p><ul><li><a href="../../api/common/#ProbabilisticCircuits.sample"><code>sample</code></a></li><li><a href="../../api/common/#ProbabilisticCircuits.MAP"><code>MAP</code></a></li><li><a href="../../api/common/#ProbabilisticCircuits.loglikelihoods"><code>loglikelihoods</code></a></li><li><a href="../../api/common/#ProbabilisticCircuits.mini_batch_em"><code>mini_batch_em</code></a></li><li><a href="../../api/common/#ProbabilisticCircuits.full_batch_em"><code>full_batch_em</code></a></li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../learning/">« Learning</a><a class="docs-footer-nextpage" href="../../api/common/">Common APIs »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Tuesday 8 March 2022 00:19">Tuesday 8 March 2022</span>. Using Julia version 1.6.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
